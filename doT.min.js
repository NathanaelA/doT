(function(){"use strict";var cache,doT,mangles,resolveDefs,sid,skip,startend,tags,unescape;startend={append:{start:"' + (",end:") + '",endEncode:").encodeHTML() + '"},split:{start:"'; out += (",end:"); out += '",endEncode:").encodeHTML(); out += '"}};doT={version:"0.2.0",templateSettings:{use:/\{\{#([\s\S]+?)\}\}/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,varname:"it",strip:true,"with":true,dynamicList:"it._dynamic",startend:startend.append},startend:startend,mangles:{},tags:{}};cache={};sid=0;skip=/$^/;tags=doT.tags;tags.interpolate={regex:/\{\{\s*=([\s\S]*?)\}\}/g,func:function(m,code){var cse;cse=doT.templateSettings.startend;return cse.start+unescape(code)+cse.end}};tags.encode={regex:/\{\{\s*!([\s\S]*?)\}\}/g,func:function(m,code){var cse;cse=doT.templateSettings.startend;return cse.start+unescape(code)+cse.endEncode}};tags.conditional={regex:/\{\{\s*\?(\?)?\s*([\s\S]*?)\}\}/g,func:function(m,elsecase,code){if(elsecase){if(code){return"' ; } else if ( "+unescape(code)+" ) { out += '"}else{return"'; } else { out += '"}}else{if(code){return"'; if ( "+unescape(code)+" ) { out += '"}else{return"'; } out += '"}}}};tags.iterate={regex:/\{\{\s*~\s*(?:(\S+?)\s*\:\s*([\w$]+)\s*(?:=>\s*([\w$]+))?\s*)?\}\}/g,func:function(m,iterate,iname,vname){var _ref;if(!iterate){return"'; } } out += '"}if(!vname){_ref=[iname,"i"+ ++sid],vname=_ref[0],iname=_ref[1]}iterate=unescape(iterate);return"';      var arr"+sid+" = "+iterate+";      if( arr"+sid+" ) {        var "+vname+", "+iname+" = -1, l"+sid+" = arr"+sid+".length-1;        while( "+iname+" < l"+sid+" ){          "+vname+" = arr"+sid+"["+iname+" += 1];          out += '"}};tags.iterateFor={regex:/\{\{\s*:\s*(?:(\S+?)\s*\:\s*([\w$]+)\s*(?:=>\s*([\w$]+))?\s*)?\}\}/g,func:function(m,iterate,iname,vname){var inpname,_ref;if(!iterate){return"'; } } out += '"}inpname="i"+ ++sid;if(!vname){_ref=[iname,"i"+ ++sid],vname=_ref[0],iname=_ref[1]}return"';      var "+inpname+" = "+iterate+";      if ( "+inpname+" ) {        var "+vname+", "+iname+";        for ("+iname+" in "+inpname+" ) {          "+vname+" = "+inpname+"[ "+iname+" ];          out += '"}};tags.content_for={regex:/\{\{\s*>([\s\S]*?)\}\}/g,func:function(m,id){this.multiple_contents=true;if(id){return"';      contents[current_out] = out;      out_stack.push(current_out);      current_out='"+unescape(id).trim()+"';      out = contents[current_out] = '"}else{return"';      contents[current_out] = out;      out = contents[current_out = out_stack.pop()] += '"}}};tags.xx_includeDynamic={regex:/\{\{\s*@@\s*(\S+?)\(([\s\S]*?)\)\s*\}\}/g,func:function(m,tmpl,args){var vname;sid+=1;vname="tmpl"+sid;return"';      var "+vname+" = "+doT.templateSettings.dynamicList+"[ '"+unescape(tmpl)+"' ];      if ('string' === typeof "+vname+") "+vname+" = {name: "+vname+"};      out += doT.render({name: "+vname+".name, args: "+vname+".args || arguments}) + '"}};tags.xy_render={regex:/\{\{\s*@\s*(\S+?)\(([\s\S]*?)\)\s*\}\}/g,func:function(m,tmpl,args){return"' + doT.render( '"+tmpl+"' "+(args?","+unescape(args):"")+" ) + '"}};tags.zz_evaluate={regex:/\{\{([\s\S]*?)\}\}/g,func:function(m,code){return"'; "+unescape(code)+"; out += '"}};mangles=doT.mangles;mangles["05_define"]=resolveDefs=function(block,compileParams){var c,def;if(!(this.use||this.define)){return str}c=this;def=compileParams.def||{};return block.toString().replace(c.define||skip,function(m,code,assign,value){if(code.indexOf("def.")===0){code=code.substring(4)}if(!(code in def)){if(assign===":"){if(c.defineParams){value.replace(c.defineParams,function(m,param,v){return def[code]={arg:param,text:v}})}if(!(code in def)){def[code]=value}}else{new Function("def","def['"+code+"'] = "+value)(def)}}return""}).replace(c.use||skip,function(m,code){var v;if(c.useParams){code=code.replace(c.useParams,function(m,s,d,param){var rw;if(def[d]&&def[d].arg&&param){rw=(d+":"+param).replace(/'|\\/g,"_");def.__exp=def.__exp||{};def.__exp[rw]=def[d].text.replace(new RegExp("(^|[^\\w$])"+def[d].arg+"([^\\w$])","g"),"$1"+param+"$2");return s+("def.__exp['"+rw+"']")}})}v=new Function("def","return "+code)(def);if(v){return resolveDefs.call(c,v,compileParams)}else{return v}})};mangles["10_strip"]=function(str,compileParams){if(!this.strip){return str}return str.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,"")};mangles["20_escape_quotes"]=function(str,compileParams){return str.replace(/'|\\/g,"\\$&")};mangles["50_tags"]=function(str,compileParams){var t_id,t_name,taglist;taglist=Object.keys(doT.tags).sort();for(t_id in taglist){t_name=taglist[t_id];str=str.replace(doT.tags[t_name].regex,function(){return doT.tags[t_name].func.apply(compileParams,arguments)})}return str};mangles["70_escape_spaces"]=function(str,compileParams){return str.replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")};mangles["80_cleanup"]=function(str,compileParams){return str.replace(/(\s|;|}|^|{)out\+='';/g,"$1").replace(/\s*\+\s*''/g,"").replace(/(\s|;|}|^|{)out\+=''\+/g,"$1out+=")};mangles["80_function_basics"]=function(str,compileParams){if(compileParams.multiple_contents){return"      var out_stack = [], contents = {}, current_out = '_content';      var out = '"+str+"';      contents[current_out] = out;      return contents;    "}else{return" var out = '"+str+"';      return out;    "}};mangles["80_with"]=function(str,compileParams){if(!this["with"]){return str}return"with("+(true===this["with"]?this.varname:this["with"])+") {"+str+"}"};mangles["95_functionize"]=function(str,compileParams){try{return new Function(this.varname,str)}catch(e){throw new Error(""+e+' in "'+str+'"')}};if(typeof module!=="undefined"&&module!==null?module.exports:void 0){module.exports=doT}else if(typeof define!=="undefined"&&define!==null?define.amd:void 0){define(function(){return doT})}else{this.doT=doT}if(!String.prototype.encodeHTML){(function(){var match,rules;rules={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"};match=/&(?!#?\w+;)|<|>|"|'|\//g;return String.prototype.encodeHTML=function(){return this.replace(match,function(m){return rules[m]||m})}})()}unescape=function(code){return code.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")};doT.unescape=unescape;doT.compile=function(tmpl,def){var compile_params,m_id,m_name,mangles_list;compile_params={def:def};mangles_list=Object.keys(doT.mangles).sort();for(m_id in mangles_list){m_name=mangles_list[m_id];tmpl=doT.mangles[m_name].call(doT.templateSettings,tmpl,compile_params)}return tmpl};doT.template=doT.compile;doT.getCached=function(tmpl){if(!tmpl){return cache}if(!cache[tmpl]){throw new Error("Template not found: "+tmpl)}return cache[tmpl]};doT.setCached=function(fns){return cache=fns};doT.exportCached=function(){var f,id,str;str="";for(id in cache){f=cache[id];str+=',"'+id+'": '+f.toString()}return"{"+str.substring(1)+"}"};doT.addCached=function(id,fn){var f,i;if("object"===typeof id){for(i in id){f=id[i];doT.addCached(i,f)}return}return cache[id]=fn};doT.render=function(tmpl){var src;"object"!==typeof tmpl&&(tmpl={name:tmpl});if(!cache[tmpl.name]){src=doT.autoload(tmpl.name);if(false===src){throw new Error("Template not found: "+tmpl.name)}doT.addCached(tmpl.name,doT.compile(src))}return cache[tmpl.name].apply(this,tmpl.args||Array.prototype.slice.call(arguments,1))};doT.autoloadDOM=function(opts){return function(name){var src;src=document.getElementById(name);if(!src||!src.type||"text/x-dot-tmpl"!==src.type){return false}else{return src.innerHTML}}};doT.autoloadFS=function(opts){return function(name){try{return opts.fs.readFileSync(""+opts.root+"/"+name.replace(".","/")+".tmpl")}catch(e){return false}}};doT.autoloadFail=function(){return false};doT.autoload=doT.autoloadDOM()}).call(this);